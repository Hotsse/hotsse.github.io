---
layout: post
title: Spring DI(의존 주입)
categories: [Spring]
comments: true
---

의존?

한 클래스가 다른 클래스의 메서드를 실행하는 것을 **의존** 이라고 한다. 의존은 변경에 의해 영향을 받는 관계를 의미한다.

아래는 의존 관계가 있는 객체를 직접 생성하고 실행하는 예제이다.

{% highlight java %}
public class TestService {

    // 의존 객체를 직접 생성
    private TestDao testDao = new TestDao();

    public void test(){
        testDao.something(); // 의존 객체 실행
    }
}
{% endhighlight %}

-------------

DI(Dependency Injection, 의존 주입)

DI(의존 주입)은 의존 관계가 있는 의존 객체를 클래스 내에서 생성하지 않고 본인 객체가 생성 시에 이미 생성된 의존 객체를 전달해 주는 것을 뜻한다.
의존 주입을 사용하지 않고 직접 생성하는 방식에서, 의존 객체가 수정이 있고 이를 생성하기 위한 인터페이스가 변경된다면 해당 의존 객체를 직접 생성하는 모든 클래스에서 수정이 일어나야 한다. 객체 지향 설계를 고려한다면 의존 주입은 의존 객체 변경의 유연함을 보장하는 개발 방식이라고 할 수 있다.

아래는 의존 관계가 있는 객체에 수동으로 DI(의존 주입)을 진행하는 예제이다.

{% highlight java %}
/**
* TestService.java
*/
public class TestService {

    private TestDao testDao;

    public TestService(TestDao testDao){
        this.testDao = testDao; // 의존 주입
    }

    public void test{
        testDao.something(); // 의존 객체 실행
    }
}
{% endhighlight %}

{% highlight java %}
/**
* Main.java
*/
public class Main {

    public static void main(String[] args){

        TestDao testDao = new TestDao();
        TestService testService = new TestService(testDao);

        testService.test();
    }
}
{% endhighlight %}

-------------

Spring 의 DI 설정

앞서 설명한 DI 설정은 Spring 기능을 사용하지 않고 수동으로 DI 를 진행한 경우이다. Spring 은 각 객체를 싱글톤 형태의 Bean(빈)으로 관리하기에 각 Bean 을 생성 할 시에, 의존 주입을 진행해야 한다.

Spring 에서 Bean 을 관리하는 방법은 여러가지이나 두 가지 예제로 알아보겠다.

-------------

Spring 의 DI 설정(XML)

{% highlight xml %}
<!-- applicationContext.xml -->
<?xml version="1.0" encoding="UTF-8">

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="testDao" class="hotsse.TestDao">
    </bean>

    <bean id="testService" class="hotsse.TestService">
        <constructor-arg ref="testDao">
    </bean>
</beans>
{% endhighlight %}

{% highlight java %}
import org.psringframework.context.support.GenericXmlApplicationContext;

/**
* Main.java
*/
public class Main {
    public static void main(String[] args){
        GenericXmlApplicationContext ctx = 
            new GenericXmlApplicationContext("classpath:applicationContext.xml");

        TestService testService = ctx.getBean("testService", TestService.class);

        testService.test();

        ctx.close();
    }
}
{% endhighlight %}